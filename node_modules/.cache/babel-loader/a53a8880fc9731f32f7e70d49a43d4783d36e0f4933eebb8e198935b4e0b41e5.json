{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\igor\\\\Desktop\\\\online-shop\\\\client\\\\src\\\\components\\\\AppRouter.js\",\n  _s = $RefreshSig$();\nimport React, { useContext, useEffect, useState } from 'react';\nimport { Route, Routes } from 'react-router-dom';\nimport * as routes from '../routes';\nimport ForbiddenPage from \"../pages/ForbiddenPage\";\nimport { Context } from \"../index\";\nimport { checkAuth } from \"../api/userApi\";\nimport { Spinner } from \"react-bootstrap\";\nimport { observer } from \"mobx-react-lite\";\nimport { getAllDevices } from \"../api/deviceApi\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AppRouter = _s(observer(_c = _s(() => {\n  _s();\n  const {\n    user,\n    device\n  } = useContext(Context);\n  const [isLoading, setIsLoading] = useState(true);\n  useEffect(() => {\n    const checkToken = async () => {\n      try {\n        const response = await checkAuth();\n        if (response) {\n          localStorage.setItem('token', response.token);\n          user.setIsAuth(true);\n        }\n      } catch (e) {\n        if (e.response.status === 401) {\n          user.setIsAuth(false);\n          localStorage.removeItem('token');\n        }\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    checkToken();\n  }, []);\n  return isLoading ? /*#__PURE__*/_jsxDEV(Spinner, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 21\n  }, this) : /*#__PURE__*/_jsxDEV(Routes, {\n    children: routes.routes.map(route => {\n      var _user$user;\n      if (route.isAuth && ((_user$user = user.user) === null || _user$user === void 0 ? void 0 : _user$user.isAuth) === false) return /*#__PURE__*/_jsxDEV(Route, {\n        path: '*',\n        element: /*#__PURE__*/_jsxDEV(ForbiddenPage, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 46,\n          columnNumber: 89\n        }, this)\n      }, 'Key' + route.path, false, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 73\n      }, this);\n      return /*#__PURE__*/_jsxDEV(Route, {\n        path: route.path,\n        element: /*#__PURE__*/_jsxDEV(route.Component, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 58\n        }, this)\n      }, `route ${route.path}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 24\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 34\n  }, this);\n}, \"kfIE5wkpR+CXZGiN8ACnP/LoUe8=\")), \"kfIE5wkpR+CXZGiN8ACnP/LoUe8=\");\n_c2 = AppRouter;\nexport default AppRouter;\nvar _c, _c2;\n$RefreshReg$(_c, \"AppRouter$observer\");\n$RefreshReg$(_c2, \"AppRouter\");","map":{"version":3,"names":["React","useContext","useEffect","useState","Route","Routes","routes","ForbiddenPage","Context","checkAuth","Spinner","observer","getAllDevices","AppRouter","user","device","isLoading","setIsLoading","checkToken","response","localStorage","setItem","token","setIsAuth","e","status","removeItem","map","route","isAuth","path"],"sources":["C:/Users/igor/Desktop/online-shop/client/src/components/AppRouter.js"],"sourcesContent":["import React, {useContext, useEffect, useState} from 'react';\r\nimport {Route, Routes} from 'react-router-dom'\r\nimport * as routes from '../routes'\r\nimport ForbiddenPage from \"../pages/ForbiddenPage\";\r\n\r\nimport {Context} from \"../index\";\r\nimport {checkAuth} from \"../api/userApi\";\r\nimport {Spinner} from \"react-bootstrap\";\r\nimport {observer} from \"mobx-react-lite\";\r\nimport {getAllDevices} from \"../api/deviceApi\";\r\n\r\n\r\nconst AppRouter = observer(() => {\r\n    const {user,device} = useContext(Context)\r\n    const [isLoading, setIsLoading] = useState(true)\r\n    useEffect(() => {\r\n         const checkToken = async () => {\r\n            try {\r\n                const response = await checkAuth()\r\n                if (response) {\r\n                    localStorage.setItem('token', response.token)\r\n                    user.setIsAuth(true)\r\n                }\r\n            } catch (e) {\r\n                if (e.response.status === 401) {\r\n                    user.setIsAuth(false)\r\n                    localStorage.removeItem('token')\r\n                }\r\n            } finally {\r\n                setIsLoading(false)\r\n            }\r\n        }\r\n\r\n        checkToken()\r\n\r\n\r\n    }, [])\r\n\r\n\r\n    return (\r\n\r\n\r\n        isLoading ? <Spinner/> : <Routes>\r\n            {routes.routes.map(route => {\r\n                if (route.isAuth && user.user?.isAuth === false) return <Route key={'Key' + route.path} path={'*'}\r\n                                                                               element={<ForbiddenPage/>}/>\r\n                return <Route path={route.path} element={<route.Component/>} key={`route ${route.path}`}/>\r\n            })}\r\n        </Routes>\r\n\r\n\r\n    );\r\n});\r\n\r\nexport default AppRouter;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAGC,UAAU,EAAEC,SAAS,EAAEC,QAAQ,QAAO,OAAO;AAC5D,SAAQC,KAAK,EAAEC,MAAM,QAAO,kBAAkB;AAC9C,OAAO,KAAKC,MAAM,MAAM,WAAW;AACnC,OAAOC,aAAa,MAAM,wBAAwB;AAElD,SAAQC,OAAO,QAAO,UAAU;AAChC,SAAQC,SAAS,QAAO,gBAAgB;AACxC,SAAQC,OAAO,QAAO,iBAAiB;AACvC,SAAQC,QAAQ,QAAO,iBAAiB;AACxC,SAAQC,aAAa,QAAO,kBAAkB;AAAC;AAG/C,MAAMC,SAAS,MAAGF,QAAQ,SAAC,MAAM;EAAA;EAC7B,MAAM;IAACG,IAAI;IAACC;EAAM,CAAC,GAAGd,UAAU,CAACO,OAAO,CAAC;EACzC,MAAM,CAACQ,SAAS,EAAEC,YAAY,CAAC,GAAGd,QAAQ,CAAC,IAAI,CAAC;EAChDD,SAAS,CAAC,MAAM;IACX,MAAMgB,UAAU,GAAG,YAAY;MAC5B,IAAI;QACA,MAAMC,QAAQ,GAAG,MAAMV,SAAS,EAAE;QAClC,IAAIU,QAAQ,EAAE;UACVC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEF,QAAQ,CAACG,KAAK,CAAC;UAC7CR,IAAI,CAACS,SAAS,CAAC,IAAI,CAAC;QACxB;MACJ,CAAC,CAAC,OAAOC,CAAC,EAAE;QACR,IAAIA,CAAC,CAACL,QAAQ,CAACM,MAAM,KAAK,GAAG,EAAE;UAC3BX,IAAI,CAACS,SAAS,CAAC,KAAK,CAAC;UACrBH,YAAY,CAACM,UAAU,CAAC,OAAO,CAAC;QACpC;MACJ,CAAC,SAAS;QACNT,YAAY,CAAC,KAAK,CAAC;MACvB;IACJ,CAAC;IAEDC,UAAU,EAAE;EAGhB,CAAC,EAAE,EAAE,CAAC;EAGN,OAGIF,SAAS,gBAAG,QAAC,OAAO;IAAA;IAAA;IAAA;EAAA,QAAE,gBAAG,QAAC,MAAM;IAAA,UAC3BV,MAAM,CAACA,MAAM,CAACqB,GAAG,CAACC,KAAK,IAAI;MAAA;MACxB,IAAIA,KAAK,CAACC,MAAM,IAAI,eAAAf,IAAI,CAACA,IAAI,+CAAT,WAAWe,MAAM,MAAK,KAAK,EAAE,oBAAO,QAAC,KAAK;QAA0B,IAAI,EAAE,GAAI;QACnC,OAAO,eAAE,QAAC,aAAa;UAAA;UAAA;UAAA;QAAA;MAAG,GADrB,KAAK,GAAGD,KAAK,CAACE,IAAI;QAAA;QAAA;QAAA;MAAA,QACK;MAC3F,oBAAO,QAAC,KAAK;QAAC,IAAI,EAAEF,KAAK,CAACE,IAAK;QAAC,OAAO,eAAE,QAAC,KAAK,CAAC,SAAS;UAAA;UAAA;UAAA;QAAA;MAAG,GAAO,SAAQF,KAAK,CAACE,IAAK,EAAC;QAAA;QAAA;QAAA;MAAA,QAAG;IAC9F,CAAC;EAAC;IAAA;IAAA;IAAA;EAAA,QACG;AAIjB,CAAC,kCAAC;AAAC,MAxCGjB,SAAS;AA0Cf,eAAeA,SAAS;AAAC;AAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}